<div id="content">
  <div class="filter-col p-3" data-simplebar>
    <h6 class="mt-3 font-weight-bold">Filter Options</h6>
    <div class="mt-4 d-flex justify-content-around">
      <div class="d-flex flex-column align-items-center">
        <a href="javascript:void(0);" class="data-action" data-target="#loadFilterModal" data-toggle="modal">
          <i class="fa fa-upload"></i></a>
        <span class="text-muted">Load</span>
      </div>
      <div class="d-flex flex-column align-items-center">
        <a href="javascript:void(0);" class="data-action" data-target="#saveFilterModal" data-toggle="modal"><i
          class="fa fa-download"></i></a>
        <span class="text-muted">Save</span>
      </div>
      <div class="d-flex flex-column align-items-center">
        <a href="javascript:void(0);" class="data-action"><i class="fa fa-list-ul"></i></a>
        <span class="text-muted">Organize</span>
      </div>
    </div>
    <hr>
    <div class="mb-2">
      <div class="input-group">
        <input type="text" class="form-control" placeholder="Search">
        <div class="input-group-append">
          <span class="input-group-text"><i class="fa fa-search"></i></span>
        </div>
      </div>
      <div class="d-flex justify-content-end">
        <a class="text-muted" href="javascript:void(0);">clear all filters</a>
      </div>
    </div>
    <div class="panel-group mt-1" role="tablist" id="filterAccordion" aria-multiselectable="true">
      <ng-container *ngFor="let filter of filters; let filterIndex=index">
        <div class="panel panel-default">
          <div class="panel-heading" role="tab" [id]="filter.key">
            <h4 class="panel-title">
              <a role="button" data-toggle="collapse" data-parent="#filterAccordion"
                 [href]="'#' + filter.key + 'filter'"
                 aria-expanded="true" [attr.aria-controls]="filter.key + 'filter'"
                 (click)="filter.isExpanded = !filter.isExpanded">
                {{ filter.name }}
                <i class="fa float-right" [ngClass]="[ filter.isExpanded ? 'fa-minus' : 'fa-plus' ]"></i>
              </a>
            </h4>
          </div>
          <div [id]="filter.key + 'filter'" class="panel-collapse collapse" role="tabpanel"
               [attr.aria-labelledby]="filter.key">
            <div class="panel-body">
              <ul class="m-0">
                <li class="d-flex" *ngFor="let value of filter.values;">
                  <div>
                    <input class="mr-1" type="checkbox">
                  </div>
                  <p class="m-0">{{ value }}</p>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </ng-container>
    </div>
    <hr>
    <div class="mb-2">
      <div>
        SKUs
        <a class="text-muted float-right" href="javascript:void(0);" (click)="clearAllSKUs()">clear all skus</a>
      </div>
      <div class="input-group mt-2">
        <input type="text" class="form-control" [(ngModel)]="searchText" name="searchSKU" placeholder="Search SKU">
        <div class="input-group-append">
          <span class="input-group-text"><i class="fa fa-search"></i></span>
        </div>
      </div>
    </div>
    <div class="mb-2" style="max-height: 300px; overflow: auto;font-size: 12px;" data-simplebar>
      <div class="bg-white mt-1 p-1 pl-2 d-flex" *ngFor="let sku of skus | filter: getCallback(); let i=index">
        <div style="margin-top: 3px;">
          <input class="mr-1" type="checkbox" [(ngModel)]="sku.isChecked" (change)="onFilterCheckBoxChange()">
        </div>
        <p class="m-0">{{ sku.name }}</p>
      </div>
    </div>
  </div>
  <div class="row content-col mb-2">
    <div class="col-12 pl-2 pr-1">
      <div class="bg-white rounded shadow mt-2">
        <div class="d-flex justify-content-between align-items-center p-1">
          <div class="d-flex justify-content-between align-items-center ml-2 pt-2">
            <p class="font-weight-bold">Forcast Analysis</p>
            <!--<p class="ml-2 text-muted">Load Week {{currentWeek}}</p>-->
            <p class="ml-2 text-muted">Load Week 25</p>
          </div>
          <div>

          </div>
        </div>
        <div id="chartContainer1" style="height: 370px; width: 100%; margin-left:auto;margin-right:auto;"></div>
      </div>

      <div class="bg-white rounded shadow mt-2">
        <p class="font-weight-bold ml-2 pt-2">Feature Analysis
          <span style="float:right; margin-right:10px;">
              <div class="form-group w-50 ml-1">
                <select name="plant" class="minimal" required>
                  <option selected>Select</option>
                  <option>1</option>
                  <option>2</option>
                  <option>3</option>
                </select>
              </div>
            </span>
        </p>


        <div id="chartContainer2" style="height: 150px; width: 100%; margin-left:auto;margin-right:auto;">

        </div>
        <div class="data-strip d-none">
          <ul>
            <li>201910</li>
            <li>201915</li>
            <li>201920</li>
            <li>201925</li>
            <li>201930</li>
            <li>201935</li>
            <li>201940</li>
          </ul>
        </div>
      </div>

      <div class="bg-white shadow mt-2">
        <div class="row m-0">
          <div class="col-2 p-0">
            <div class="row m-0">
              <div class="invisible col-12 header-col" style="padding: 0.65rem">
                XXXXXX
              </div>
            </div>
            <div class="row m-0">
              <div class="col-12 header-col header-text">
                Final Forecast
              </div>
            </div>
            <div class="row m-0">
              <div class="col-12 header-col header-text">
                Fcst Value Add
              </div>
            </div>
            <div class="row m-0">
              <div (click)="putValueInFinal('ML')" class="col-12 header-col ml-text">
                ML Forecast
              </div>
            </div>
            <div class="row m-0">
              <div (click)="putValueInFinal('APO')" class="col-12 header-col aop-text">
                APO Forecast
              </div>
            </div>
            <div class="row m-0">
              <div class="col-12 header-col actual-text">
                Actuals
              </div>
            </div>
            <div class="row m-0">
              <div class="col-12 header-col header-text">
                Actuals LY
              </div>
            </div>

          </div>
          <div class="col-9 p-0">
            <div class="panel panel-default">
              <div class="center-block fix-width scroll-inner">
                <table class="table table-striped">
                  <thead>
                  <tr>
                    <th class="font-weight-bold" *ngFor="let data of graphData">
                      Week {{ data.week }}
                    </th>
                  </tr>
                  </thead>
                  <tbody>
                  <tr>
                    <ng-container *ngFor="let data of graphData; let i=index">
                      <td class="font-weight-bold cursor-pointer" (click)="selectedWeekComments=graphData[i].comments">
                        {{ data.finalForecast }}
                      </td>
                    </ng-container>
                  </tr>
                  <tr>
                    <ng-container *ngFor="let data of graphData; let i=index">
                      <td (dblclick)="onDblClickInput(i)">
                        <input type="text" class="table-inputbox" (input)="onValueInput(data.calenderYearWeek, i)"
                               [(ngModel)]="data.fcstValueAdd">
                      </td>
                    </ng-container>
                  </tr>
                  <tr>
                    <td *ngFor="let data of graphData">
                      {{ data.ml }}
                    </td>
                  </tr>
                  <tr>
                    <td *ngFor="let data of graphData">
                      {{ data.apo }}
                    </td>
                  </tr>
                  <tr>
                    <td *ngFor="let data of graphData">
                      {{ data.actuals }}
                    </td>
                  </tr>
                  <tr>
                    <td *ngFor="let data of graphData">
                      {{ data.actualslastyear }}
                    </td>
                  </tr>
                  </tbody>
                </table>
              </div>
              <div class="col-sm-12 text-center m-2">
                <a href="#" class="btn btn-primary custom-link btn-xs" data-toggle="modal" data-target="#myModal2">Save
                  Plan</a>
              </div>
            </div>
          </div>
          <div class="col-1 p-0">
            <div class="row m-0">
              <div class="col-12 footer-col" style="padding: 0.65rem">
                Total
              </div>
            </div>
            <div class="row m-0">
              <div class="col-12 footer-col">
                {{ totalData.finalCastTotal }}
              </div>
            </div>
            <div class="row m-0">
              <div class="col-12 footer-col invisible">
                {{ totalData.fcstValueAdd || 0 }}
              </div>
            </div>
            <div class="row m-0">
              <div class="col-12 footer-col">
                {{ totalData.mlTotal }}
              </div>
            </div>
            <div class="row m-0">
              <div class="col-12 footer-col">
                {{ totalData.apoTotal }}
              </div>
            </div>
            <div class="row m-0">
              <div class="col-12 footer-col">
                {{ totalData.actuals }}
              </div>
            </div>
            <div class="row m-0">
              <div class="col-12 footer-col">
                {{ totalData.lastYearTotal }}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="events-col pt-1 pb-3 pl-2 pr-2">
    <div class="events-container shadow mt-1 mb-1 p-2 bg-white" data-simplebar>
      <div class="mt-2">
        <h4>Events</h4>
        <div class="m-1 p-1 d-flex">
          <div>
            <input class="mr-1" type="checkbox">
          </div>
          <p class="m-0">All Events</p>
        </div>
        <div class="block m-1 p-1 d-flex" *ngFor="let event of events">
          <div>
            <input class="mr-1" type="checkbox">
          </div>
          <p class="m-0">{{ event.name }}</p>
        </div>
      </div>
      <div class="mt-2">
        <h4>Weather</h4>
        <div class="m-1 p-1 d-flex">
          <div>
            <input class="mr-1" type="checkbox">
          </div>
          <p class="m-0">All Weathers</p>
        </div>
        <div class="block m-1 p-1 d-flex" *ngFor="let weather of weathers">
          <div>
            <input class="mr-1" type="checkbox">
          </div>
          <p class="m-0">{{ weather.name }}</p>
        </div>
      </div>
      <div class="mt-2" *ngIf="selectedWeekComments.length">
        <h4>Comments</h4>
        <div class="block m-1 p-1 d-flex" *ngFor="let selectedWeekComment of selectedWeekComments">
          <p class="m-0">{{ selectedWeekComment }}</p>
        </div>
      </div>
    </div>
  </div>
</div>

<!--Select Options Modal-->
<a href="javascript:void(0);" [hidden]="true" data-target="#selectOptionsModal" data-toggle="modal"
   #selectOptionsModalBtn>Open Options Modal</a>
<div class="modal select-options-modal" id="selectOptionsModal" tabindex="-1" role="dialog" data-backdrop="static">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close" [class.invisible]="!graphData.length" #selectOptionsModalCancel>
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <app-create-plan [events]="eventsSubject.asObservable()"
                         (submit)="createPlan($event)"></app-create-plan>
      </div>
    </div>
  </div>
</div>

<!--Save a Plan Modal-->
<a href="javascript:void(0);" [hidden]="true" data-target="#saveAPlansModal" data-toggle="modal" #saveAPlansModalBtn>Save
  a Plan Modal</a>
<div class="modal fade save-plan-modal" id="saveAPlansModal" tabindex="-1" role="dialog" data-backdrop="static"
     aria-labelledby="saveAPlansModal">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLongTitle">Save the Plan</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close" #PlanNameModalBtn><span
          aria-hidden="true">&times;</span></button>
      </div>
      <div class="modal-body">
        <input type="text" class="form-control" id="plan_name" placeholder="Name of the Plan" required>
        <p class="text-center mt-4">
          <a href="javascript:void(0);" (click)="savePlan()" class="btn btn-secondary custom-link btn-xs">Ok
            <ng-container *ngIf="savePlanLoader">
              <i class="fa fa-spinner fa-spin" aria-hidden="true"></i>
            </ng-container>
          </a>
        </p>
      </div>
    </div>
  </div>
</div>

<!--Graph Comment Modal-->
<a href="javascript:void(0);" [hidden]="true" data-target="#commentFormModal" data-toggle="modal" #commentFormModalBtn>Open
  Graph Comment Form Modal</a>
<div class="modal fade comment-modal" id="commentFormModal" tabindex="-1" role="dialog" data-backdrop="static">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Comment</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close" #commentFormModalCancel>
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form #commentForm="ngForm">
          <div class="form-group">
            <label class="d-none" for="comment">
              Comment
            </label>
            <input type="text" class="form-control" id="comment" name="comment"  placeholder="eg. Comment" ngModel required>
          </div>
          <button type="button" class="btn float-right btn-secondary" [disabled]="!commentForm.valid"
                  [ngClass]="{'disabled': !commentForm.valid}"
                  (click)="onCommentFormSubmit(commentForm,commentForm.value)">Submit
          </button>
        </form>
      </div>
    </div>
  </div>
</div>

<!--Final Forecast Comment Modal-->
<a href="javascript:void(0);" [hidden]="true" data-target="#finalForecastCommentModal" data-toggle="modal"
   #finalForecastCommentModalBtn>Open Graph Comment Form Modal</a>
<div class="modal fade final-comment-modal" id="finalForecastCommentModal" tabindex="-1" role="dialog" data-backdrop="static">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Comment</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close" #finalForecastCommentModalCancel
                (click)="selectedWeekIndex=null;finalForecastCommentForm.resetForm()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form #finalForecastCommentForm="ngForm">
          <div class="form-group">
            <label class="d-none" for="finalForecastComment">
              Comment
            </label>
            <input type="text" class="form-control" id="finalForecastComment" name="comment" placeholder="eg. Comment" ngModel required>
          </div>
          <button type="button" class="btn float-right btn-dark" [disabled]="!finalForecastCommentForm.valid"
                  [ngClass]="{'disabled': !finalForecastCommentForm.valid}"
                  (click)="onFinalForecastCommentSubmit(finalForecastCommentForm.value)">Submit
          </button>
        </form>
      </div>
    </div>
  </div>
</div>

<!--Save Filter Modal-->
<a href="javascript:void(0);" [hidden]="true" data-target="#saveFilterModal" data-toggle="modal" #saveFilterModal>Open
  Save Filter Modal</a>
<div class="modal fade save-filter-modal" id="saveFilterModal" tabindex="-1" role="dialog" data-backdrop="static">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Save Filter</h5>
        <button type="button" class="close invisible" data-dismiss="modal" aria-label="Close" #saveFilterModalCancel>
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form #saveFilterModalForm="ngForm">
          <div>
            <div class="form-group">
              <label for="filterName">
                  <span>Filter Name</span>
              </label>
              <input type="text" class="form-control" id="filterName"  placeholder="eg. Green Bottles" required>
            </div>
          </div>
          <div class="d-flex justify-content-between">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">
              Cancel
            </button>
            <button type="button" class="btn btn-dark" [disabled]="!saveFilterModalForm.valid"
                    [ngClass]="{'disabled': !saveFilterModalForm.valid}"
                    (click)="onCommentFormSubmit(saveFilterModalForm,saveFilterModalForm.value)">Save Changes
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<!--Load Filter Modal-->
<a href="javascript:void(0);" [hidden]="true" data-target="#loadFilterModal" data-toggle="modal" #loadFilterModal>Open
  Load Filter Modal</a>
<div class="modal fade load-filter-modal" id="loadFilterModal" tabindex="-1" role="dialog" data-backdrop="static">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Load Filter</h5>
        <button type="button" class="close invisible" data-dismiss="modal" aria-label="Close" #loadFilterModalCancel>
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form #saveFilterModalForm="ngForm">

          <div class="d-flex justify-content-between">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
            <button type="button" class="btn btn-dark">Load Selected</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
